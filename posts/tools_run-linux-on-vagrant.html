<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="怎样使用Vagrant在命令行终端命上管理Linux虚拟机？" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="一、Vgrant的安装" /><meta property="og:description" content="一、Vgrant的安装" /><link rel="canonical" href="https://blog.algs.tech/posts/tools_run-linux-on-vagrant.html" /><meta property="og:url" content="https://blog.algs.tech/posts/tools_run-linux-on-vagrant.html" /><meta property="og:site_name" content="极客开发者-博客" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-31T21:41:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="怎样使用Vagrant在命令行终端命上管理Linux虚拟机？" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-31T21:41:00+08:00","datePublished":"2023-01-31T21:41:00+08:00","description":"一、Vgrant的安装","headline":"怎样使用Vagrant在命令行终端命上管理Linux虚拟机？","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.algs.tech/posts/tools_run-linux-on-vagrant.html"},"url":"https://blog.algs.tech/posts/tools_run-linux-on-vagrant.html"}</script><title>怎样使用Vagrant在命令行终端命上管理Linux虚拟机？ | 极客开发者-博客</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="极客开发者-博客"><meta name="application-name" content="极客开发者-博客"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/assets/dist/fonts/main.css"><link rel="stylesheet" href="/assets/dist/bootstrap.min.css"><link rel="stylesheet" href="/assets/dist/fontawesome.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="/assets/lib/tocbot/tocbot.min.css"><link rel="stylesheet" href="/assets/dist/magnific-popup.min.css"> <script src="/assets/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/img/about/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">极客开发者-博客</a></div><div class="site-subtitle font-italic">在探索未知与梦想的道路上，让我们拥有共同的称呼 -- 开发者</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/geekdex" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['pan.hy','foxmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>怎样使用Vagrant在命令行终端命上管理Linux虚拟机？</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>怎样使用Vagrant在命令行终端命上管理Linux虚拟机？</h1><div class="post-meta text-muted"> <span> 发表于 <em class="" data-ts="1675172460" data-df="YYYY/MM/DD" data-toggle="tooltip" data-placement="bottom"> 2023/01/31 </em> </span> <span style="float: right;"> <a href="https://lab.aoco.tech/convert?url=https://raw.githubusercontent.com/geekdex/blog/refs/heads/main/_posts/2023-01-31-tools_run-linux-on-vagrant.md" class="view-source" target="_blank" style="color: #2a5caa; text-decoration: none; font-weight: 500;"> 查看Codelabs </a> &nbsp;|&nbsp; <a href="https://github.com/geekdex/blog/blob/main/_posts/2023-01-31-tools_run-linux-on-vagrant.md" class="view-source" target="_blank" style="color: #2a5caa; text-decoration: none; font-weight: 500;"> 查看源码 </a> </span><div class="d-flex justify-content-between"> <span> 作者 <em> <a href="https://blog.algs.tech">blog.algs.tech</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3387 字"> <em>18 分钟</em>阅读</span></div></div></div><div class="post-content"><h2 id="一vgrant的安装"><span class="mr-2">一、Vgrant的安装</span><a href="#一vgrant的安装" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Vagrant是一个跨平台的虚拟机管理工具，我们以 Deepin 20.2.3 为例，安装和使用 Vagrant。我们在这里所说的 Vagrant 包括 Vagrant 工具本身 和 虚拟引擎工具 VirtualBox。</p><h3 id="11-安装vagrant"><span class="mr-2">1.1 安装Vagrant</span><a href="#11-安装vagrant" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>安装 vagrant 时，使用的 VirtualBox 版本必须要得到 对应 Vagrant 版本的支持，在写这篇文档的时候，我安装的 Vagrant 版本是 <code class="language-plaintext highlighter-rouge">2.2.18</code> ，对应的 VirtualBox 版本是 <code class="language-plaintext highlighter-rouge">6.1.26</code>。</p><p>Vagrant 安装包下载地址：<a href="https://releases.hashicorp.com/vagrant/">https://releases.hashicorp.com/vagrant/</a>，在这里可以看到Vagrant 当前的最新版本以及历史版本，我们可以选择到对应操作系统的对应版本进行下载。</p><p>VirtualBox 安装包下载地址：<a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a>，同样，在这里我们可以找到 VirtualBox 的对应版本。</p><p>将 Vagrant 和 VirtualBox 指定的安装包下载到本地后，执行安装命令，如下</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c"># 安装 Vagrant</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> ./vagrant_2.2.18_x86_64.deb
<span class="c"># 安装 VirtualBox</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> ./virtualbox-6.1_6.1.26-145957_Debian_buster_amd64.deb
</pre></table></code></div></div><h3 id="12-安装验证"><span class="mr-2">1.2 安装验证</span><a href="#12-安装验证" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>执行以下命令验证vagrnat是否能正常使用</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c"># 创建 vagrant 项目路径</span>
<span class="nb">mkdir</span> ~/my-vagrant-project
<span class="c"># 初始化 centos8虚拟机</span>
vagrant init centos/8
<span class="c"># 启动虚拟机</span>
vagrant up
<span class="c"># 停止虚拟机</span>
vagrant halt
<span class="c"># 删除虚拟机</span>
vagrant destroy
</pre></table></code></div></div><p>如果以上步骤可以顺利执行，则代表 Vagrant 安装成功。</p><h2 id="二vagrant的使用"><span class="mr-2">二、Vagrant的使用</span><a href="#二vagrant的使用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="21-安装-box"><span class="mr-2">2.1 安装 box</span><a href="#21-安装-box" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>我们可以把 Vgarnt 中的 <code class="language-plaintext highlighter-rouge">box</code> 理解为某种操作系统的镜像文件，也可以理解为虚拟机的本身，我们可以去添加我们想要的 <code class="language-plaintext highlighter-rouge">box</code>， Vagrant 可以去管理这些 <code class="language-plaintext highlighter-rouge">box</code>，我们在启动虚拟机时可以选择我们想要的 <code class="language-plaintext highlighter-rouge">box</code>。</p><p>我们可以通过<a href="https://app.vagrantup.com/boxes/search">https://app.vagrantup.com/boxes/search</a>去找到我们想要的box，我们可以看到 box 名称格式为 <code class="language-plaintext highlighter-rouge">A/B</code>， 其中 A 代表创建 box 的用户名，B 为 box 的名称，如<code class="language-plaintext highlighter-rouge">centos/7</code>。</p><ul><li>安装指定的 box</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant box add centos/7
</pre></table></code></div></div><p>此时看到如下选择提示</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>pan@pan-PC:~<span class="nv">$ </span>vagrant box add centos/7
<span class="o">==&gt;</span> box: Loading metadata <span class="k">for </span>box <span class="s1">'centos/7'</span>
    box: URL: https://vagrantcloud.com/centos/7
This box can work with multiple providers! The providers that it
can work with are listed below. Please review the list and choose
the provider you will be working with.

1<span class="o">)</span> hyperv
2<span class="o">)</span> libvirt
3<span class="o">)</span> virtualbox
4<span class="o">)</span> vmware_desktop

Enter your choice: 
</pre></table></code></div></div><p>因为我们使用的虚拟机引擎是<code class="language-plaintext highlighter-rouge">virtualbox</code>，所以输入<code class="language-plaintext highlighter-rouge">3</code>后按回车即下载 virtualbox 版本的 centos/7。</p><ul><li>查看已经安装的box</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant box list
</pre></table></code></div></div><h3 id="22-虚拟机的基本使用"><span class="mr-2">2.2 虚拟机的基本使用</span><a href="#22-虚拟机的基本使用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>初始化虚拟机</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># 创建一个空项目目录</span>
<span class="nb">mkdir</span> ~/test
<span class="c"># 进入项目目录</span>
<span class="nb">cd</span> ~/test
<span class="c"># 使用centos/7初始化vagrant项目</span>
vagrant init centos/7
</pre></table></code></div></div><p>此时在目录下生成一个名为 <code class="language-plaintext highlighter-rouge">Vagrantfile</code> 的配置文件，在后续，我们可以通过修改 <code class="language-plaintext highlighter-rouge">Vagrantfile</code> 来定义虚拟机，接下来的相关操作指令都将在 vagrant 项目目录下执行</p><ul><li>启动虚拟机</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant up
</pre></table></code></div></div><p>虚拟机启动之后，会将本地的项目目录自动挂载到虚拟机里的 <code class="language-plaintext highlighter-rouge">/vagrant</code> 目录</p><ul><li>连接虚拟机</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># 默认使用vagrant用户连接到虚拟机</span>
vagrant ssh
</pre></table></code></div></div><p>另外，我们可以通过<code class="language-plaintext highlighter-rouge">vagrant ssh-config</code>命令查看ssh配置信息，包括虚拟机与本地的映射端口、证书文件等，如下</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>pan@pan-PC:~/Work/vagrant/centos<span class="nv">$ </span>vagrant ssh-config
Host default
  HostName 127.0.0.1
  User vagrant
  Port 2222
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
  IdentityFile /home/pan/Work/vagrant/centos/.vagrant/machines/default/virtualbox/private_key
  IdentitiesOnly <span class="nb">yes
  </span>LogLevel FATAL
</pre></table></code></div></div><p>我们也可以通过直接通过 ssh 工具连接到虚拟机，如下命令</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh vagrant@127.0.0.1 <span class="nt">-p</span> 2222 <span class="nt">-i</span> .vagrant/machines/default/virtualbox/private_key
</pre></table></code></div></div><p>vagrant用户的默认密码为<code class="language-plaintext highlighter-rouge">vagrant</code></p><p>相关参数参数</p><p><strong>-p</strong>：指定ssh端口</p><p><strong>-i</strong>：指定ssh私钥文件</p><ul><li>查看虚拟机状态</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant status
</pre></table></code></div></div><ul><li>虚拟机关机</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant halt
</pre></table></code></div></div><ul><li>暂停虚拟机</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># 再次启动虚拟机</span>
vagrant up
<span class="c"># 退出虚拟机</span>
<span class="nb">exit</span>
<span class="c"># 暂停虚拟机</span>
vagrant <span class="nb">suspend</span>
<span class="c"># 继续运行虚拟机</span>
vagrant resume
</pre></table></code></div></div><p>vagrant 将会在虚拟机暂停之后，把数据存储到我们本地硬盘，下次开启时，将从硬盘读取恢复。在虚拟机暂停的过程中，虚拟机相关服务的状态会进行保存，如<code class="language-plaintext highlighter-rouge">httpd</code> 服务的正在运行，虚拟机暂停后再继续运行虚拟机，<code class="language-plaintext highlighter-rouge">httpd</code> 服务也会继续运行</p><ul><li>重启虚拟机</ul><p>在项目目录下，执行<code class="language-plaintext highlighter-rouge">vagrant reload</code>，虚拟机将会先执行关机动作，后执行开机动作。</p><ul><li>销毁当前的虚拟机</ul><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant destroy
</pre></table></code></div></div><p>销毁虚拟机操作会将虚拟机进行关机后删除实例，如果虚拟机已经处于关机状态将直接删除。此命令只会销毁我们在当前目录创建的 虚拟机，不会销毁 box。 此时我们使用 <code class="language-plaintext highlighter-rouge">vagrant status</code> 命令查看虚拟机状态，会看到虚拟机处于 <code class="language-plaintext highlighter-rouge">not created</code> 状态。</p><h2 id="三-用vagrantfile定义虚拟机"><span class="mr-2">三. 用Vagrantfile定义虚拟机</span><a href="#三-用vagrantfile定义虚拟机" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="31-添加额外共享目录"><span class="mr-2">3.1 添加额外共享目录</span><a href="#31-添加额外共享目录" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>实际上，在虚拟机创建的时候，vagrant 会将项目目录自动挂载到 虚拟机里的 <code class="language-plaintext highlighter-rouge">/vagrant</code> 目录，实际上，我们还可以通过 定义 <code class="language-plaintext highlighter-rouge">Vagrantfile</code> 的方式来挂载其他目录。</p><p>打开 <code class="language-plaintext highlighter-rouge">Vagrantfile</code> 找到 <code class="language-plaintext highlighter-rouge"># config.vm.synced_folder "../data", "/vagrant_data"</code> 所在的行，去掉注视符号 “#”，即定义了一个目录挂载规则，第一个参数代表 宿主机当前目录的上级目录下 的 <code class="language-plaintext highlighter-rouge">data</code> 目录， 第二个参数 代表挂载 到虚拟机里的 <code class="language-plaintext highlighter-rouge">/vagrant_data</code> 目录 。我们还可以添加后面的参数，最终代码如下</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">synced_folder</span> <span class="s2">"../data"</span><span class="p">,</span> <span class="s2">"/vagrant_data"</span><span class="p">,</span> <span class="ss">create: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">owner: </span><span class="s2">"root"</span><span class="p">,</span> <span class="ss">group: </span><span class="s2">"root"</span>
</pre></table></code></div></div><p><strong>create: true</strong>：代表如果宿主机不存在对应的目录，将会创建；</p><p><strong>owner: “root”</strong>：代表挂载到虚拟机后，目录的拥有者是 root；</p><p><strong>group: “root”</strong>：代表挂载到虚拟机后，目录的所属的群组是 root。</p><p>保存好<code class="language-plaintext highlighter-rouge">Vagrantfile</code>之后，执行<code class="language-plaintext highlighter-rouge">vagrant reload</code>即完成虚拟机的重启并挂载上对应的目录。如果执行报错的话，我们需要使用<code class="language-plaintext highlighter-rouge">vagrant plugin install vagrant-vbguest --plugin-version 0.21</code> 安装vbguest插件后再次重启虚拟机。</p><h3 id="32-网络配置"><span class="mr-2">3.2 网络配置</span><a href="#32-网络配置" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>我们通常需要跟虚拟机进行通信，比如我们在虚拟机上安装了一个web服务，需要通过自己电脑的浏览器打开虚拟机上搭建的web服务。这就需要我们配置虚拟机的网络，宿主机才能与虚拟机正常通信。vagrant 提供三种网络的配置。</p><ul><li><p>端口转发（forwarded_port） 如把宿主机的 8080 端口，转发到虚拟机的 80 端口，这样 如果在宿主机访问 <code class="language-plaintext highlighter-rouge">http://localhost:8080</code> 将对转发到虚拟机的 80 端口服务。这种方法不太灵活，因为我们需要配置所有需要转发的端口。</p><li><p>私有网络（private_network） 为虚拟机手动设置IP地址，通过IP地址我们的宿主机就可以与虚拟机之间通信了，不过，我们只能通过我们的宿主机访问虚拟机。</p><li><p>公有网络（public_network） 公有网络会把虚拟机配置成在同一个局域网内可以访问的一台设备。比如我我们的电脑链接一台路由器，那么其他连接这台路由器的设备（其他电脑、平板电脑、手机等）也可以访问到我们电脑里的虚拟机。</p><li><p>配置私有网络</p></ul><p>找到 <code class="language-plaintext highlighter-rouge">config.vm.network "private_network"</code> 所在行，取消注释，第2个参数是指定的ip地址</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.10"</span>
</pre></table></code></div></div><p>接下来用<code class="language-plaintext highlighter-rouge">ping 192.168.33.10</code>命令去验证，如果有返回，代表私有网络设置成功。</p><ul><li>配置共有网络</ul><p>找到<code class="language-plaintext highlighter-rouge">config.vm.network "public_network"</code>所在行，取消注释，并且注释私有网络的配置。后执行<code class="language-plaintext highlighter-rouge">vagrant reload</code>重新加载 Vagrantfile 文件，此时需要选择指定的网卡。如下输出内容：</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>pan@pan-PC:~/Work/vagrant/ubuntu<span class="nv">$ </span>vagrant reload
<span class="o">==&gt;</span> default: Attempting graceful shutdown of VM...
<span class="o">==&gt;</span> default: Checking <span class="k">if </span>box <span class="s1">'ubuntu/xenial64'</span> version <span class="s1">'20210804.0.0'</span> is up to date...
<span class="o">==&gt;</span> default: Clearing any previously <span class="nb">set </span>forwarded ports...
<span class="o">==&gt;</span> default: Clearing any previously <span class="nb">set </span>network interfaces...
<span class="o">==&gt;</span> default: Available bridged network interfaces:
1<span class="o">)</span> enp3s0
2<span class="o">)</span> docker0
3<span class="o">)</span> vethc80d1c8
4<span class="o">)</span> vethca1c3e4
5<span class="o">)</span> veth3992844
6<span class="o">)</span> veth2014eaa
7<span class="o">)</span> vethd2642b2
8<span class="o">)</span> veth2b5b670
9<span class="o">)</span> veth21318b5
<span class="o">==&gt;</span> default: When choosing an interface, it is usually the one that is
<span class="o">==&gt;</span> default: being used to connect to the internet.
<span class="o">==&gt;</span> default: 
    default: Which interface should the network bridge to?
</pre></table></code></div></div><p>我们需要选择对应的网卡即可，此时我需要输入1后按回车，因为enp3s0是我电脑的实体网卡名称，而其他选项都是通过软件创建的虚拟网卡。</p><h3 id="33-虚拟机打包"><span class="mr-2">3.3 虚拟机打包</span><a href="#33-虚拟机打包" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>我们可以对正在运行的某个虚拟机进行打包生成镜像。这样，就可以使用新的镜像进行创建虚拟机，那么新创建的虚拟机会跟打包时的虚拟机环境一致。步骤如下：</p><p>（1）先在虚拟机删除网卡定义文件</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo rm</span> <span class="nt">-rf</span> /etc/udev/rules.d/70-persistent-net.rules
</pre></table></code></div></div><p>（2）退出虚拟机，进行打包</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant package
</pre></table></code></div></div><p>此时在当前目录生成<code class="language-plaintext highlighter-rouge">package.box</code>镜像文件</p><p>（3）将镜像文件导入box中</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># 将导入的box命名为 jkdev/ubuntu</span>
vagrant box add jkdev/ubuntu package.box
</pre></table></code></div></div><p>导入成功后，即可使用 <code class="language-plaintext highlighter-rouge">jkdev/ubuntu</code> 创建新的虚拟机</p><h3 id="34-创建多台虚拟机"><span class="mr-2">3.4 创建多台虚拟机</span><a href="#34-创建多台虚拟机" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>在实际项目中，有时候我们会把 web 服务放在一台或者多台服务器， 数据库服务器放在一台服务器。那么在本地开发中，我们也需要去模拟对应的服务器环境。如果我们可以创建多台虚拟机，这样我们就可以模拟一个真实的服务器环境。实际上， <code class="language-plaintext highlighter-rouge">Vagrantfile</code> 可以同时定义多台服务器，每一台主机都可以有自己的配置，同时我们需要把每一台主机的网络配置好，那么各台服务器之间就可以进行通信了。创建过程如下：</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1"># 创建目录</span>
<span class="n">mkdir</span> <span class="n">project</span>
<span class="c1"># 初始化Vagrantfile</span>
<span class="n">vagrant</span> <span class="n">init</span> <span class="n">ubuntu</span><span class="o">/</span><span class="n">xenial64</span>
</pre></table></code></div></div><p>在<code class="language-plaintext highlighter-rouge">Vagranfile</code> 在<code class="language-plaintext highlighter-rouge">config.vm.box = "ubuntu/xenial64"</code>下面的一行添加以下代码</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># 定义名为development的虚拟机，并启用该虚拟机</span>
<span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"development"</span> <span class="k">do</span> <span class="o">|</span><span class="n">development</span><span class="o">|</span>
<span class="k">end</span>

<span class="c1"># 定义名为production的虚拟机，并启用该虚拟机</span>
<span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"production"</span> <span class="k">do</span> <span class="o">|</span><span class="n">production</span><span class="o">|</span>
<span class="k">end</span>
</pre></table></code></div></div><p>保存文件之后，使用<code class="language-plaintext highlighter-rouge">vagrant up</code>启动虚拟机，此时同时开启两个虚拟机。启动完毕后使用<code class="language-plaintext highlighter-rouge">vagrant status</code>，可以看到已经启动了两个虚拟机</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>pan@pan-PC:~/Work/vagrant/test<span class="nv">$ </span>vagrant status
Current machine states:

development               running <span class="o">(</span>virtualbox<span class="o">)</span>
production                running <span class="o">(</span>virtualbox<span class="o">)</span>

This environment represents multiple VMs. The VMs are all listed
above with their current state. For more information about a specific
VM, run <span class="sb">`</span>vagrant status NAME<span class="sb">`</span><span class="nb">.</span>
pan@pan-PC:~/Work/vagrant/test<span class="err">$</span>
</pre></table></code></div></div><p>如果我们只想启动一台虚拟机，在启动命令的后面指定对应的虚拟机名称即可，如<code class="language-plaintext highlighter-rouge">vagrant up production</code>。如果我们需要连接该虚拟机，使用如下代码</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant ssh production
</pre></table></code></div></div><h3 id="35-配置多台虚拟机的网络"><span class="mr-2">3.5 配置多台虚拟机的网络</span><a href="#35-配置多台虚拟机的网络" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>在4中Vagrantfile文件里，我们定义了两台虚拟机，这两台虚拟机都基于<code class="language-plaintext highlighter-rouge">ubuntu/xenial64</code>，原因是该配置与定义虚拟机的配置属于同一级，如果我们想要为某台虚拟机定义独立的配置，我们需要将配置内容定义在<code class="language-plaintext highlighter-rouge">config.vm.define</code>和<code class="language-plaintext highlighter-rouge">end</code>之间。如下我们定义两个主机的私有网络，注意私有网络的IP地址不要和宿主机连接的路由器IP地址重复。如下配置</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"development"</span> <span class="k">do</span> <span class="o">|</span><span class="n">development</span><span class="o">|</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.11"</span>
<span class="k">end</span>

<span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"production"</span> <span class="k">do</span> <span class="o">|</span><span class="n">production</span><span class="o">|</span>
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.12"</span> 
<span class="k">end</span>
</pre></table></code></div></div><p>再使用<code class="language-plaintext highlighter-rouge">vagrant reload</code>即可完成配置的重加载。</p><h3 id="36-定义主机名"><span class="mr-2">3.6 定义主机名</span><a href="#36-定义主机名" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>在5中，我们一定配置好了主机的IP地址，我们接下来追加配置，定义主机的名称，如下代码：</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"development"</span> <span class="k">do</span> <span class="o">|</span><span class="n">development</span><span class="o">|</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.11"</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">hostname</span> <span class="o">=</span> <span class="s2">"dev"</span>
<span class="k">end</span>

<span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"production"</span> <span class="k">do</span> <span class="o">|</span><span class="n">production</span><span class="o">|</span>
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.12"</span> 
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">hostname</span> <span class="o">=</span> <span class="s2">"pro"</span>
<span class="k">end</span>
</pre></table></code></div></div><h3 id="37-自定义同步目录"><span class="mr-2">3.7 自定义同步目录</span><a href="#37-自定义同步目录" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>默认配置下，多台虚拟机会自动共享电脑上项目所在目录，在虚拟机里会映射到<code class="language-plaintext highlighter-rouge">/vagrant</code>目录，我们还可以单独为不同虚拟机设置不同的目录，首先在项目下创建两个目录<code class="language-plaintext highlighter-rouge">dev</code>和<code class="language-plaintext highlighter-rouge">pro</code>，修改配置文件如下</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"development"</span> <span class="k">do</span> <span class="o">|</span><span class="n">development</span><span class="o">|</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.11"</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">hostname</span> <span class="o">=</span> <span class="s2">"dev"</span>
  <span class="c1"># 将dev 目录挂载到/vagrant_dev目录</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">synced_folder</span> <span class="s2">"dev"</span><span class="p">,</span> <span class="s2">"/vagrant_dev"</span>
<span class="k">end</span>

<span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"production"</span> <span class="k">do</span> <span class="o">|</span><span class="n">production</span><span class="o">|</span>
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.12"</span> 
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">hostname</span> <span class="o">=</span> <span class="s2">"pro"</span>
  <span class="c1"># 将pro 目录挂载到/vagrant_pro目录</span>
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">synced_folder</span> <span class="s2">"pro"</span><span class="p">,</span> <span class="s2">"/vagrant_pro"</span>
<span class="k">end</span>
</pre></table></code></div></div><h3 id="38-指定cpu核心和内存"><span class="mr-2">3.8 指定cpu核心和内存</span><a href="#38-指定cpu核心和内存" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>我们还可以自定义虚拟机的内存和核心数，如下代码</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"development"</span> <span class="k">do</span> <span class="o">|</span><span class="n">development</span><span class="o">|</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.11"</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">hostname</span> <span class="o">=</span> <span class="s2">"dev"</span>
  <span class="c1"># 将dev 目录挂载到/vagrant_dev目录</span>
  <span class="n">development</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">synced_folder</span> <span class="s2">"dev"</span><span class="p">,</span> <span class="s2">"/vagrant_dev"</span>
  <span class="c1"># 指定核心数和内存</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">provider</span> <span class="s2">"virtualbox"</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="o">|</span>
    <span class="n">v</span><span class="p">.</span><span class="nf">memory</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">v</span><span class="p">.</span><span class="nf">cpus</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">define</span> <span class="s2">"production"</span> <span class="k">do</span> <span class="o">|</span><span class="n">production</span><span class="o">|</span>
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"private_network"</span><span class="p">,</span> <span class="ss">ip: </span><span class="s2">"192.168.33.12"</span> 
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">hostname</span> <span class="o">=</span> <span class="s2">"pro"</span>
  <span class="c1"># 将pro 目录挂载到/vagrant_pro目录</span>
  <span class="n">production</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">synced_folder</span> <span class="s2">"pro"</span><span class="p">,</span> <span class="s2">"/vagrant_pro"</span>
  <span class="c1"># 指定核心数和内存</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">provider</span> <span class="s2">"virtualbox"</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="o">|</span>
    <span class="n">v</span><span class="p">.</span><span class="nf">memory</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">v</span><span class="p">.</span><span class="nf">cpus</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div><p>使用<code class="language-plaintext highlighter-rouge">vagrant reload</code>完成虚拟机重加载</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%E5%B7%A5%E5%85%B7/'>工具</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" class="post-tag no-text-decoration" >虚拟机</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%E6%80%8E%E6%A0%B7%E4%BD%BF%E7%94%A8Vagrant%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%BB%88%E7%AB%AF%E5%91%BD%E4%B8%8A%E7%AE%A1%E7%90%86Linux%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%9F%20-%20%E6%9E%81%E5%AE%A2%E5%BC%80%E5%8F%91%E8%80%85-%E5%8D%9A%E5%AE%A2&url=https%3A%2F%2Fblog.algs.tech%2Fposts%2Ftools_run-linux-on-vagrant.html" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%E6%80%8E%E6%A0%B7%E4%BD%BF%E7%94%A8Vagrant%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%BB%88%E7%AB%AF%E5%91%BD%E4%B8%8A%E7%AE%A1%E7%90%86Linux%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%9F%20-%20%E6%9E%81%E5%AE%A2%E5%BC%80%E5%8F%91%E8%80%85-%E5%8D%9A%E5%AE%A2&u=https%3A%2F%2Fblog.algs.tech%2Fposts%2Ftools_run-linux-on-vagrant.html" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fblog.algs.tech%2Fposts%2Ftools_run-linux-on-vagrant.html&text=%E6%80%8E%E6%A0%B7%E4%BD%BF%E7%94%A8Vagrant%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%BB%88%E7%AB%AF%E5%91%BD%E4%B8%8A%E7%AE%A1%E7%90%86Linux%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%9F%20-%20%E6%9E%81%E5%AE%A2%E5%BC%80%E5%8F%91%E8%80%85-%E5%8D%9A%E5%AE%A2" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://service.weibo.com/share/share.php?title=%E6%80%8E%E6%A0%B7%E4%BD%BF%E7%94%A8Vagrant%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%BB%88%E7%AB%AF%E5%91%BD%E4%B8%8A%E7%AE%A1%E7%90%86Linux%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%9F%20-%20%E6%9E%81%E5%AE%A2%E5%BC%80%E5%8F%91%E8%80%85-%E5%8D%9A%E5%AE%A2&url=https%3A%2F%2Fblog.algs.tech%2Fposts%2Ftools_run-linux-on-vagrant.html" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/adb/">adb</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/pingora/">Pingora</a> <a class="post-tag" href="/tags/posix/">POSIX</a> <a class="post-tag" href="/tags/%E5%8F%8C%E7%B3%BB%E7%BB%9F/">双系统</a> <a class="post-tag" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a> <a class="post-tag" href="/tags/android%E6%9D%83%E9%99%90/">android权限</a> <a class="post-tag" href="/tags/aosp/">aosp</a> <a class="post-tag" href="/tags/archlinux/">archlinux</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc"></nav></div><script src="/assets/lib/tocbot/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/tools_run-ubuntu-on-multipass.html"><div class="card-body"> <em class="small" data-ts="1675172400" data-df="YYYY/MM/DD" > 2023/01/31 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>怎样使用Multipass快速创建和管理Ubuntu虚拟机？</h3><div class="text-muted small"><p> multipass是Ubuntu官方提供管理Ubuntu Server虚拟机的桌面工具，本文将介绍怎样使用multipass搭建Ubuntu Server虚拟机。multipass可以帮助我们快速创建和管理Ubuntu Server虚拟机。 一、安装 multipass的官方网站是https://multipass.run/， 我们可以下载Linux/Windows/Mac版本。...</p></div></div></a></div><div class="card"> <a href="/posts/tools_how_to_customize_your_cinnamon_desktop_look_like_macos.html"><div class="card-body"> <em class="small" data-ts="1746066600" data-df="YYYY/MM/DD" > 2025/05/01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>怎样自定义你的cinnmon桌面像macOS一样</h3><div class="text-muted small"><p> 一、概述 本教程也适用于使用Cinnamon桌面的Linux发行版，例如Linux Mint、Feren OS、带有Cinnamon的OpenSUSE、Debian Cinnamon版本、Fedora Cinnamon版本、带有Cinnamon桌面的Arch以及Manjaro Cinnamon版。 二、实现过程 2.1 下载壁纸 通过https://www.pling.com/p/1...</p></div></div></a></div><div class="card"> <a href="/posts/tools_how-to-use-kvm-on-debian.html"><div class="card-body"> <em class="small" data-ts="1749892140" data-df="YYYY/MM/DD" > 2025/06/14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>怎样在Debian里使用kvm虚拟机</h3><div class="text-muted small"><p> 一、安装 1.1.确认kvm是否已经启用 首先查看kvm是否正常启用，如下命令 1 lsmod | grep kvm 如果显示以下类似的信息，则表示kvm已经启用，可以继续安装 1 2 3 kvm_intel 380928 0 kvm 1146880 1 kvm_intel irqbypass ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/tools_run-ubuntu-on-multipass.html" class="btn btn-outline-primary" prompt="上一篇"><p>怎样使用Multipass快速创建和管理Ubuntu虚拟机？</p></a> <a href="/posts/git_installation-and-basic-operation.html" class="btn btn-outline-primary" prompt="下一篇"><p>使用git托管代码的基本操作方法</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "geekdex/blog", "data-repo-id": "R_kgDOIyxhcQ", "data-category": "General", "data-category-id": "DIC_kwDOIyxhcc4CUhya", "data-mapping": "pathname", "data-reactions-enabled": "anonymous", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "0", "data-lang": "zh-CN", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/k8s/">k8s</a> <a class="post-tag" href="/tags/adb/">adb</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/pingora/">Pingora</a> <a class="post-tag" href="/tags/posix/">POSIX</a> <a class="post-tag" href="/tags/%E5%8F%8C%E7%B3%BB%E7%BB%9F/">双系统</a> <a class="post-tag" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a> <a class="post-tag" href="/tags/android%E6%9D%83%E9%99%90/">android权限</a> <a class="post-tag" href="/tags/aosp/">aosp</a> <a class="post-tag" href="/tags/archlinux/">archlinux</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://blog.algs.tech">blog.algs.tech</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0">本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">发现新版本的内容。</p><button type="button" class="btn btn-primary" aria-label="Update"> 更新 </button></div></div><script src="/assets/dist/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="/assets/dist/jquery.magnific-popup.min.js"></script> <script src="/assets/dist/lazysizes.min.js"></script> <script src="/assets/dist/clipboard.min.js"></script> <script src="/assets/dist/dayjs.min.js"></script> <script src="/assets/dist/locale/zh.min.js"></script> <script src="/assets/dist/relativeTime.min.js"></script> <script src="/assets/dist/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="/assets/dist/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
